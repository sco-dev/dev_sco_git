<mvc:View controllerName="sapui5agendar.sco00agendar3.controller.Master"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form"
    xmlns:html="http://www.w3.org/1999/xhtml"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:t="sap.ui.table" displayBlock="true"
    xmlns="sap.m"
    xmlns:u="sap.uxap"
    xmlns:custom="sapui5agendar.sco00agendar3.customelements">

    <Page title="{i18n>title}" showHeader="false">
        <subHeader>
            <Toolbar id="filters">
                <Label class="sapUiSmallMarginBegin" text="Buscar Por" required="true"/>
                <Select  items="{/Opciones/Sociedades}" selectedKey="{
                                path:'/filters/i_Sociedad',
                                type : 'sapui5agendar.sco00agendar3.customelements.ExtendedString',
                                constraints:{type:'requiredSelect'}
                            }" enabled="false" forceSelection="true" width="10rem">
                    <core:Item key="{KEY}" text="{TEXT}"/>
                </Select>
                <Label  class="sapUiSmallMarginBegin" text="Patente" required="true"/>
                <Input  value="{
                                path:'/filters/Patente',
                                type : 'sapui5agendar.sco00agendar3.customelements.ExtendedString',
                                constraints:{type:'required'}
                            }" width="10rem" liveChange="toUpperCase" submit="handleSearch"/>
                <Button  text="Buscar" icon="sap-icon://search" press="handleSearch"/>
            </Toolbar>
        </subHeader>

        <content>

            <Panel  visible="{/Visibles/VistaSalfaRent}" class="sapUiNoContentPadding">

                <Panel  class="sapUiNoContentPadding sapUiTinyMargin" headerText="Datos del Contrato" visible="{/Visibles/Contrato}" binding="{/Contrato}">
                    <f:Form  editable="true">
                        <f:layout>
                            <f:ResponsiveGridLayout  labelSpanXL="5" labelSpanL="5" labelSpanM="5" labelSpanS="5" adjustLabelSpan="false" emptySpanXL="0" emptySpanL="0" emptySpanM="0" emptySpanS="0" columnsXL="3" columnsL="3" columnsM="2" singleContainerFullSize="false"/>

                        </f:layout>
                        <f:formContainers>
                            <f:FormContainer >
                                <f:formElements>
                                    <f:FormElement  label="Rut Cliente">
                                        <f:fields>
                                            <Text  text="{RUT_CLIENTE}"/>
                                        </f:fields>
                                    </f:FormElement>
                                    <f:FormElement  label="Fono">
                                        <f:fields>
                                            <Text  text="{FONO}"/>
                                        </f:fields>
                                    </f:FormElement>
                                    <f:FormElement  label="Posee Reemplazo">
                                        <f:fields>
                                            <Text  text="{POSEE_REEMPLAZO}"/>
                                        </f:fields>
                                    </f:FormElement>
                                    <f:FormElement  label="Rend. Neumatico">
                                        <f:fields>
                                            <Text  text="{RENDIMIENTO_NEUMATICO}"/>
                                        </f:fields>
                                    </f:FormElement>
                                </f:formElements>
                            </f:FormContainer>
                            <f:FormContainer >
                                <f:formElements>
                                    <f:FormElement  label="Cliente">
                                        <f:fields>
                                            <Text text="{CLIENTE}"/>
                                        </f:fields>
                                    </f:FormElement>
                                    <f:FormElement  label="Km. Contratado">
                                        <f:fields>
                                            <Text  text="{KM_CONTRATADO}"/>
                                        </f:fields>
                                    </f:FormElement>
                                    <f:FormElement  label="Horas Remplazo">
                                        <f:fields>
                                            <Text text="{HORAS_REEMPLAZO}"/>
                                        </f:fields>
                                    </f:FormElement>
                                    <f:FormElement  label="Email Adm.">
                                        <f:fields>
                                            <Text  text="{EMAIL}"/>
                                        </f:fields>
                                    </f:FormElement>
                                </f:formElements>
                            </f:FormContainer>
                            <f:FormContainer >
                                <f:formElements>
                                    <f:FormElement  label="Administrador">
                                        <f:fields>
                                            <Text  text="{ADMINISTRADOR}"/>
                                        </f:fields>
                                    </f:FormElement>
                                    <f:FormElement  label="Deducible">
                                        <f:fields>
                                            <Text  text="{DEDUCIBLE}"/>
                                        </f:fields>
                                    </f:FormElement>
                                    <f:FormElement  label="Plazo Contratado">
                                        <f:fields>
                                            <Text  text="{PLAZO_CONTRATADO}"/>
                                        </f:fields>
                                    </f:FormElement>
                                </f:formElements>
                            </f:FormContainer>
                        </f:formContainers>

                    </f:Form>
                </Panel>

                <Panel  headerText="Listado de Conductores">
                    <t:Table  rows="{/Conductores}" selectedIndex="{/i_Conductor}" selectionMode="Single" visibleRowCount="3" selectionBehavior="RowOnly" columnResize="true">
                        <t:extension>
                            <Toolbar >
                                <Button  icon="sap-icon://add" text="Crear" press="handleCrearConductor"/>
                                <Button  icon="sap-icon://edit" text="Actualizar" visible="{=${/i_Conductor} >= 0}" press="handleActualizarConductor"/>
                            </Toolbar>
                        </t:extension>
                        <t:noData>
                            <Text textAlign="Center" class="sapUiTableCtrlEmptyMsg" text="No se han agregado conductores"/>
                        </t:noData>
                        <t:columns>
                            <t:Column >
                                <Label  text="Rut"/>
                                <t:template>
                                    <Text  text="{RUT}" wrapping="false"/>
                                </t:template>
                            </t:Column>
                            <t:Column >
                                <Label  text="Nombre"/>
                                <t:template>
                                    <Text  text="{NOMBRE}" wrapping="false"/>
                                </t:template>
                            </t:Column>
                            <t:Column >
                                <Label  text="Apellido"/>
                                <t:template>
                                    <Text  text="{APELLIDO}" wrapping="false"/>
                                </t:template>
                            </t:Column>
                            <t:Column >
                                <Label  text="Movil"/>
                                <t:template>
                                    <Text  text="{MOVIL}" wrapping="false"/>
                                </t:template>
                            </t:Column>
                            <t:Column >
                                <Label text="Fono"/>
                                <t:template>
                                    <Text text="{FONO}" wrapping="false"/>
                                </t:template>
                            </t:Column>
                            <t:Column>
                                <Label text="Email"/>
                                <t:template>
                                    <Text text="{EMAIL}" wrapping="false"/>
                                </t:template>
                            </t:Column>
                        </t:columns>
                    </t:Table>
                </Panel>
                <Panel headerText="Información" class="sapUiMediumMarginTop">
                    <l:Splitter>
                        <Panel>
                            <layoutData>
                                <l:SplitterLayoutData size="50%" resizable="false"/>
                            </layoutData>
                            <Title text="Datos del Vehículo"/>
                            <t:Table rows="{/Vehiculos}" selectionMode="None" visibleRowCount="1" selectionBehavior="RowOnly">
                                <t:extension>
                                    <Toolbar>
                                        <Button icon="sap-icon://synchronize" text="Actualizar Km" press="handleActualizarKm"/>
                                        <Button icon="sap-icon://history" text="Historial de Mantenciones" press="handleHistorialMantenciones"/>
                                    </Toolbar>
                                </t:extension>
                                <t:noData>
                                    <Text textAlign="Center" class="sapUiTableCtrlEmptyMsg" text="No existen vehículos"/>
                                </t:noData>
                                <t:columns>
                                    <t:Column>
                                        <Label text="Marca"/>
                                        <t:template>
                                            <Text text="{MARCA}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="Modelo"/>
                                        <t:template>
                                            <Text text="{MODELO}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="Patente"/>
                                        <t:template>
                                            <Text text="{PATENTE}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="Año"/>
                                        <t:template>
                                            <Text text="{ANIO}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="KM Registrados"/>
                                        <t:template>
                                            <Text text="{KILOMETRAJE}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="KM Actual" required="true"/>
                                        <t:template>
                                            <Input value="{
                                                    path:'KILOMETRAJE_ACTUAL',
                                                    type:'sap.ui.model.type.Integer',
                                                    constraints:{minimum:1}
                                                }" submit="handleActualizarKm"/>
                                        </t:template>
                                    </t:Column>
                                </t:columns>
                            </t:Table>
                        </Panel>

                        <Panel>
                            <layoutData>
                                <l:SplitterLayoutData size="50%" resizable="false"/>
                            </layoutData>
                            <Title text="Historial de Mantenciones"/>
                            <t:Table rows="{/HistorialMantenciones}" selectionMode="None" visibleRowCount="5">
                                <t:extension>
                                    <Toolbar>
                                    </Toolbar>
                                </t:extension>
                                <t:noData>
                                    <Text textAlign="Center" class="sapUiTableCtrlEmptyMsg" text="No existen manteciones"/>
                                </t:noData>
                                <t:columns>
                                    <t:Column>
                                        <Label text="Fecha"/>
                                        <t:template>
                                            <Text text="{FECHA}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="Orden"/>
                                        <t:template>
                                            <Text text="{ORDEN}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="Descripción de Servicio"/>
                                        <t:template>
                                            <Text text="{DESC_SERVICIO}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="Rut Cliente"/>
                                        <t:template>
                                            <Text text="{RUT_CLIENTE}"/>
                                        </t:template>
                                    </t:Column>
                                    <t:Column>
                                        <Label text="Taller"/>
                                        <t:template>
                                            <Text text="{TALLER}"/>
                                        </t:template>
                                    </t:Column>
                                </t:columns>
                            </t:Table>
                        </Panel>
                    </l:Splitter>
                </Panel>

            </Panel>

        </content>

        <footer>
            <Toolbar>
                <Button id="errorPopover" icon="sap-icon://message-popup" visible="{= ${message>/}.length > 0}" text="{= ${message>/}.length}" type="Emphasized" press="handleMessagePopoverPress"/>
                <ToolbarSpacer/>
                <Button icon="sap-icon://add" text="Crear Agenda" visible="{/Visibles/CrearAgenda}" press="handleCrearAgenda" enabled="true"/>
                <Button icon="sap-icon://search" text="Consultar Agenda" visible="true" press="handleConsultarAgenda" enabled="true"/>
            </Toolbar>
        </footer>
    </Page>

</mvc:View>
